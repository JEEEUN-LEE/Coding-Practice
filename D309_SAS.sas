/*-----------------------------------------------------------
 SAS 활용 노하우 - Outlier (이상치 처리)
-----------------------------------------------------------*/

/*극단값을  제거하는 것은, 극단적인 값이 발생하는 상황의 데이터를 고려하지 않는다는 의미이기도 하여 특수한 상황을 분석하기 위해선 예욋값을 제거하면 안된다
표준편차의 일정 배수 이상 떨어진 값을 평균값에서 제거하는 방법이 있다 */

/*
 🔹 일반적인 이상치 제거 방법
   - 평균으로부터 표준편차(Standard Deviation)의 일정 배수 이상 벗어난 값을 제외.
   - 예: |x - 평균| > 3 × 표준편차 → 이상치로 판단.
*/


/*-----------------------------------------------------------
 1. 예시 데이터 준비
-----------------------------------------------------------*/
data cars;
	set sashelp.cars;  /* SAS 내장 데이터셋 사용 */
run;


/*-----------------------------------------------------------
 2. 평균과 표준편차 계산
-----------------------------------------------------------*/
proc means data = cars mean std;
	var horsepower;  /* 분석 대상 변수 */
	output out = summary mean = mean_hp std = std_hp;
run;


/*-----------------------------------------------------------
 3. 표준편차 3배 범위 이외의 값 제거하기
-----------------------------------------------------------*/
data filtered_cars;
	merge cars summary;  /* 원본 데이터 + 통계 요약 데이터 병합 */
	if abs(horsepower - mean_hp) <= 3 * std_hp then output;  /* 평균 ± 3SD 이내 값만 출력 */
run;


/*-----------------------------------------------------------
 4. 결과 확인
-----------------------------------------------------------*/
proc print data = filtered_cars;
run;